<section class="report-section">
  <h2>Line-Level Performance</h2>
  <figure class="report-figure">
    <img src="{{ lineYieldImg }}" alt="Yield by Line" />
    <figcaption>Yield performance across AOI lines.</figcaption>
  </figure>
  <figure class="report-figure">
    <img src="{{ lineFalseCallImg }}" alt="False Calls by Line" />
    <figcaption>False-call rate per board.</figcaption>
  </figure>
  <figure class="report-figure">
    <img src="{{ linePpmImg }}" alt="PPM vs DPM" />
    <figcaption>Comparison of false-call PPM and confirmed-defect DPM.</figcaption>
  </figure>
  <table class="report-table">
    <thead>
      <tr>
        <th>Line</th>
        <th>Window Yield %</th>
        <th>Part Yield %</th>
        <th>Confirmed Defects</th>
        <th>False Calls / Board</th>
        <th>False Call PPM</th>
        <th>False Call DPM</th>
        <th>Defect DPM</th>
        <th>Boards / Day</th>
        <th>Total Windows</th>
        <th>Total Parts</th>
      </tr>
    </thead>
    <tbody>
      {% for metric in lineMetrics %}
      <tr>
        <td>{{ metric.line }}</td>
        <td>{{ (metric.windowYield if metric.windowYield is not none else metric.yield)|round(2) }}</td>
        <td>
          {% if metric.partYield is not none %}
            {{ metric.partYield|round(2) }}
          {% else %}
            --
          {% endif %}
        </td>
        <td>{{ metric.confirmedDefects|round(0) }}</td>
        <td>{{ metric.falseCallsPerBoard|round(2) }}</td>
        <td>
          {% if metric.falseCallPpm is not none %}
            {{ metric.falseCallPpm|round(2) }}
          {% else %}
            --
          {% endif %}
        </td>
        <td>
          {% if metric.falseCallDpm is not none %}
            {{ metric.falseCallDpm|round(2) }}
          {% else %}
            --
          {% endif %}
        </td>
        <td>
          {% if metric.defectDpm is not none %}
            {{ metric.defectDpm|round(2) }}
          {% else %}
            --
          {% endif %}
        </td>
        <td>{{ metric.boardsPerDay|round(2) }}</td>
        <td>{{ metric.totalWindows|round(0) }}</td>
        <td>{{ metric.totalParts|round(0) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>
